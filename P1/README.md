# BUILD

docker build -f _vchizhov-1 -t host_vchizhov .

docker build -f _vchizhov-2 -t router_vchizhov .

# README for GNS3 and Docker Setup with Routing Configuration

## Project Overview

In this task, we will set up a network environment in **GNS3** using **Docker** containers. The goal is to create two Docker images with specific requirements and use them within GNS3. The first image will contain **BusyBox** or an equivalent solution, and the second will include the following routing software components:

1. **Zebra** or **Quagga** (Routing management software)
2. **BGPD** (BGP Daemon) active and configured
3. **OSPD** (OSPF Daemon) active and configured
4. **IS-IS** (Intermediate System to Intermediate System) routing engine service
5. **BusyBox** or an equivalent minimal system

### Requirements

- **GNS3** must be installed and configured.
- **Docker** must be installed on your virtual machine.
- Two Docker images are needed:
  1. **First image**: A simple image with **BusyBox** or an equivalent.
  2. **Second image**: An image containing:
     - **Zebra/Quagga**
     - **BGPD**, **OSPD**, and **IS-IS** configured.

---

## Prerequisites

### Install GNS3 and Docker

Before starting with the Docker containers, ensure that GNS3 and Docker are installed on your virtual machine.

#### GNS3 Installation
Follow the official GNS3 installation guide for your operating system:
- [GNS3 Installation Guide](https://docs.gns3.com/)

#### Docker Installation
Follow the official Docker installation guide for your operating system:
- [Docker Installation Guide](https://docs.docker.com/get-docker/)

Once Docker is installed, ensure that Docker is running by checking the status:
```bash
docker --version
```

---
## Zebra
**Zebra** — это сетевой демон (сервис), который используется в некоторых маршрутизаторах и системах для реализации маршрутизации. Он служит в качестве "сердечника" для обмена маршрутизационными данными между различными протоколами маршрутизации и другими компонентами системы.

Zebra был основным компонентом в наборе утилит для маршрутизации, известных как **Quagga** (сейчас заменён другим проектом, **FRRouting** — FRR). Zebra обеспечивает интерфейс для управления маршрутизацией, который позволяет другим сервисам (например, BGP, OSPF, IS-IS) обмениваться данными с операционной системой или другими протоколами маршрутизации.

---

### Задачи Zebra

1. **Обмен маршрутами между протоколами маршрутизации**:  
   Zebra действует как связующий элемент между различными протоколами маршрутизации, такими как OSPF, BGP, RIP и другими, и операционной системой.

2. **Интерфейс с ядром ОС**:  
   Zebra управляет таблицей маршрутизации ядра операционной системы, обновляя её в ответ на изменения маршрутов, полученные от протоколов маршрутизации.

3. **Маршрутизация на уровне ядра**:  
   Zebra предоставляет интерфейсы для работы с таблицей маршрутов ядра ОС. Он передаёт информацию о маршрутах, полученных от различных протоколов маршрутизации, в таблицу маршрутов ядра.

4. **Поддержка нескольких протоколов маршрутизации**:  
   Zebra работает с несколькими протоколами маршрутизации, такими как:
   - **BGP** (Border Gateway Protocol)
   - **OSPF** (Open Shortest Path First)
   - **RIP** (Routing Information Protocol)
   - **ISIS** (Intermediate System to Intermediate System)
   - и другие.

---

### Пример использования Zebra

Zebra часто используется в сочетании с другими инструментами маршрутизации, такими как **Quagga** или **FRRouting**. Например, FRRouting использует **Zebra** как основной демон для взаимодействия с ядром ОС и обновления таблиц маршрутизации, а также с другими сервисами маршрутизации, такими как BGP и OSPF.

---

### Преимущества использования Zebra

- **Модульность**: Позволяет использовать различные протоколы маршрутизации в одной системе.
- **Гибкость**: Zebra даёт возможность динамически обновлять таблицы маршрутов в ответ на изменения в сети.
- **Совместимость**: Он предоставляет интерфейс для работы с протоколами маршрутизации и может быть интегрирован с другими сервисами и инструментами маршрутизации.

---

**Примечание:** В современных системах **FRRouting (FRR)** — это обновлённая версия **Quagga**, и теперь он является более популярным выбором для использования в качестве демона маршрутизации, где **Zebra** продолжает играть важную роль в управлении маршрутизацией.

## BGPD

**BGP** — протокол динамической маршрутизации, предназначен для обмена информацией о достижимости подсетей между автономными системами (АС, англ. AS — autonomous system), то есть группами маршрутизаторов под единым техническим и административным управлением, использующими протокол внутридоменной маршрутизации для определения маршрутов внутри себя и протокол междоменной маршрутизации для определения маршрутов доставки пакетов в другие АС. Передаваемая информация включает в себя список АС, к которым имеется доступ через данную систему. Выбор наилучших маршрутов осуществляется исходя из правил, принятых в сети. 
Каждая автономная система в сети имеет уникальный идентификатор AS (AS number). BGP помогает маршрутизаторам в разных AS обмениваться информацией о доступных путях.
iBGP (Internal BGP) — это BGP, который используется внутри одной автономной системы (AS) для обмена маршрутами между маршрутизаторами в рамках этой системы.
eBGP (External BGP) — это BGP, который используется для обмена маршрутами между различными автономными системами. Например, между вашими маршрутизаторами и маршрутизаторами вашего интернет-провайдера.
OSPF и BGP: OSPF — это протокол маршрутизации внутри одной автономной системы, а BGP — между автономными системами. OSPF часто используется внутри AS для распространения маршрутов, а BGP используется для обмена маршрутов между AS.

**BGPD** — это демон, который реализует протокол маршрутизации **BGP** (Border Gateway Protocol). BGP — это протокол, используемый для обмена маршрутами между автономными системами (AS) в интернете или между различными сетями в рамках организации. Демон **BGPD** (часто называемый **BGP daemon**) отвечает за управление и настройку BGP-сессий на маршрутизаторе, а также за обмен маршрутов с соседними маршрутизаторами через протокол BGP.

### Основные функции BGPD:
1. **Управление BGP-сессиями**:  
   BGPD управляет установлением и поддержанием BGP-сессий с соседними маршрутизаторами (BGP-пирами). Эти сессии обеспечивают обмен информацией о маршрутах между различными автономными системами (AS).

2. **Обмен маршрутами между AS**:  
   BGP используется для обмена маршрутами между различными автономными системами в интернете. BGPD управляет процессом обмена маршрутами, принимая решения о том, какой маршрут использовать для достижения определённой сети, основываясь на различных атрибутах маршрута.

3. **Поддержка политики маршрутизации**:  
   BGPD предоставляет гибкие механизмы для реализации политики маршрутизации, что позволяет операторам сети манипулировать порядком, при котором маршруты выбираются или анонсируются. Это позволяет, например, устанавливать предпочтения по маршруту в зависимости от различных факторов, таких как стоимость или пропускная способность.

4. **Обработка анонсирования и получения маршрутов**:  
   BGPD принимает решение о том, какие маршруты анонсировать своим соседям, а также какие маршруты принимать от соседей и добавлять в локальную таблицу маршрутов.

5. **Поддержка различных типов маршрутов**:  
   BGP может работать с несколькими типами маршрутов, включая:
   - **IP-маршруты** — маршруты для обмена данными по сети.
   - **L2VPN EVPN** — маршруты для виртуальных частных сетей второго уровня.
   - **MPLS (Multiprotocol Label Switching)** — маршруты для протоколов MPLS.

### Пример работы BGPD:

1. Когда маршрутизатор запускает **BGPD**, он начинает устанавливать сессии с соседями, которые также используют BGP. Эти соседи называются **BGP-пирами**.
2. После того как сессии установлены, каждый из маршрутизаторов начинает обмениваться информацией о своих маршрутах, которая включает в себя все доступные пути к различным сетям.
3. **BGPD** анализирует информацию о маршрутах от всех соседей, выбирает наилучший путь с учётом множества параметров (например, длина пути, стоимость, предпочтения) и добавляет его в свою таблицу маршрутизации.
4. Когда состояние сети меняется (например, один из маршрутов становится недоступен), **BGPD** обновляет информацию и анонсирует изменения соседям.

### Важные атрибуты BGP, которые обрабатывает BGPD:
- **AS Path**: Список автономных систем, через которые прошёл маршрут.
- **Next Hop**: Адрес следующего маршрутизатора на пути к сети.
- **Local Preference**: Локальное предпочтение маршрута.
- **MED (Multi Exit Discriminator)**: Приоритет для выбора маршрута через определённый выход.
- **Community**: Дополнительная метка для маршрутов, которая может использоваться для настройки политики маршрутизации.

### Где используется BGPD?
- **Интернет-провайдеры (ISP)** используют BGPD для обмена маршрутами между различными автономными системами, чтобы обеспечить доступность интернета для своих пользователей.
- **Крупные корпоративные сети** могут использовать BGP для маршрутизации трафика между различными офисами или филиалами через интернет или VPN-соединения.
- **Облачные сервисы и дата-центры** часто используют BGP для динамической маршрутизации трафика между различными частями своих инфраструктур.

### Пример конфигурации BGPD:

На маршрутизаторе, который работает с BGP (например, в системе **FRRouting**), конфигурация BGPD может выглядеть так:

```bash
vtysh
conf t

# Настройка имени маршрутизатора
hostname routeur1

# Настройка BGP с AS 65001
router bgp 65001

# Определение соседа BGP с AS 65002
neighbor 1.1.1.2 remote-as 65002

# Активировать BGP для IPv4
address-family ipv4 unicast
  neighbor 1.1.1.2 activate
exit-address-family

# Настройка OSPF для внутренней маршрутизации
router ospf
  network 0.0.0.0/0 area 0
```

### BGPD в контексте FRRouting (FRR):
**FRRouting (FRR)** — это современная замена для **Quagga** и включает в себя множество маршрутизаторов, в том числе **BGPD** для BGP-маршрутизации. FRR позволяет управлять маршрутами с помощью различных протоколов, включая BGP, OSPF, RIP и IS-IS, предоставляя гибкость в настройке и использовании маршрутизации.

Таким образом, **BGPD** играет ключевую роль в сетях, которые используют **BGP** для маршрутизации и управления трафиком между автономными системами или крупными сетями.


## OSPFd
**OSPFd** — это демон, который реализует **OSPF (Open Shortest Path First)**, один из самых популярных и широко используемых протоколов маршрутизации внутри автономных систем (IGP — Interior Gateway Protocol). **OSPFd** отвечает за выполнение алгоритмов маршрутизации OSPF на маршрутизаторе, обмен информацией о маршрутах с другими маршрутизаторами OSPF и обновление таблицы маршрутизации маршрутизатора.

### Основные функции OSPFd:

1. **Обмен маршрутами между маршрутизаторами**:
   OSPF используется для обмена информацией о маршрутах между маршрутизаторами внутри одной автономной системы (AS). Маршрутизаторы обмениваются **LSA (Link-State Advertisements)** для получения и обмена информацией о состоянии их интерфейсов и сети.

2. **Алгоритм SPF (Shortest Path First)**:
   OSPF использует алгоритм **Dijkstra's SPF**, чтобы вычислить наименьший путь к каждой сети, основываясь на информации о состоянии связей, полученной от соседей. В результате этого маршрутизатор строит дерево кратчайших путей (SPT - Shortest Path Tree), которое определяет, какой маршрут использовать для передачи трафика.

3. **Иерархия OSPF (Area)**:
   OSPF поддерживает разделение сети на **области** (Areas). Основная область — это **Area 0 (Backbone)**, которая соединяет все другие области. Разделение на области позволяет улучшить масштабируемость сети, снизив нагрузку на процессор и память маршрутизаторов, поскольку информация о состоянии соединений в разных областях обменяется только на границе областей, а не по всей сети.

4. **Типы маршрутизаторов**:
   - **Internal Router**: Маршрутизатор, который полностью находится в одной области.
   - **Area Border Router (ABR)**: Маршрутизатор, который соединяет несколько областей.
   - **Backbone Router**: Маршрутизатор, который подключен к основной области (Area 0).
   - **Autonomous System Boundary Router (ASBR)**: Маршрутизатор, который соединяет OSPF с другими протоколами маршрутизации, такими как BGP.

5. **Динамическая маршрутизация**:
   OSPF является динамическим протоколом маршрутизации, что означает, что маршрутизаторы автоматически адаптируются к изменениям в сети, например, когда происходит сбой или добавляется новый маршрутизатор. Это позволяет сети автоматически адаптироваться к изменениям и поддерживать актуальность маршрутов.

### Как работает OSPF?

1. **Обнаружение соседей**:
   OSPF использует процесс **Hello Protocol**, чтобы обнаружить и установить соседние отношения между маршрутизаторами. Эти отношения необходимы для обмена информацией о маршрутах и состоянии сети.

2. **Обмен информацией о состоянии связи**:
   Когда маршрутизаторы устанавливают соседство, они начинают обмениваться **LSA** — объявлениями о состоянии связи, которые содержат информацию о сетевых интерфейсах, соседях, состояниях связей и других характеристиках сети.

3. **Сборка топологии сети**:
   После обмена LSA маршрутизаторы создают **базу данных состояния связей** (LSDB - Link-State Database), которая содержит полную информацию о топологии сети.

4. **Вычисление маршрутов**:
   Алгоритм SPF анализирует базу данных состояния связей и вычисляет наилучшие пути к каждой сети, после чего добавляет эти пути в таблицу маршрутизации.

### Пример конфигурации OSPFd:

На маршрутизаторе, работающем с OSPF, конфигурация демона **OSPFd** может выглядеть следующим образом:

```bash
vtysh
conf t

# Настройка имени маршрутизатора
hostname routeur1

# Включение процесса OSPF с процессом ID 1
router ospf 1

# Настройка интерфейсов, которые участвуют в OSPF
network 10.1.1.0/24 area 0
network 192.168.1.0/24 area 0

# Настройка приоритетов для интерфейсов (для выбора DR/BDR)
interface eth0
ip ospf priority 10
interface eth1
ip ospf priority 5

# Для добавления маршрута по умолчанию
default-information originate

# Завершаем настройку OSPF
exit
```

### Пояснение команд:
- **router ospf 1** — включает процесс OSPF с идентификатором 1.
- **network 10.1.1.0/24 area 0** — включает подсеть 10.1.1.0/24 в область OSPF Area 0.
- **interface eth0** — настраивает интерфейс **eth0**, где **ip ospf priority** используется для назначения приоритета на интерфейсе, что влияет на выбор **DR** (Designated Router) и **BDR** (Backup Designated Router) в OSPF-сети.
- **default-information originate** — заставляет маршрутизатор распространять маршрут по умолчанию через OSPF.

### Почему используется OSPF?
1. **Скалируемость**:
   OSPF может эффективно работать в крупных сетях благодаря использованию областей, что помогает снизить нагрузку на процессоры и память маршрутизаторов.
   
2. **Производительность**:
   OSPF использует алгоритм SPF, который достаточно быстр и эффективен для вычисления маршрутов, а также позволяет сети быстро адаптироваться к изменениям.
   
3. **Поддержка множества типов сетей**:
   OSPF поддерживает различные типы сетей (например, точка-точка, многоточечные сети) и имеет гибкую настройку для работы в разных топологиях.

4. **Поддержка различных типов маршрутизации**:
   OSPF не ограничивается только маршрутизацией IPv4; он также поддерживает маршрутизацию **IPv6**, что делает его удобным для перехода на новые протоколы.

### Пример работы OSPFd:

1. **Маршрутизаторы обмениваются сообщениями "Hello"**, чтобы установить соседские отношения.
2. **Маршрутизаторы обмениваются LSR (Link-State Request)** и LSA (Link-State Advertisements), чтобы передать информацию о своих интерфейсах и состояниях связей.
3. На основе полученных данных каждый маршрутизатор вычисляет наилучшие маршруты и обновляет свою таблицу маршрутизации.

### Заключение:
**OSPFd** — это компонент, который реализует процесс маршрутизации OSPF на маршрутизаторе, обменившийся маршрутами с соседями в пределах одной автономной системы. Этот протокол широко используется в крупных и средних сетях благодаря своей производительности, скалируемости и способности динамически реагировать на изменения в топологии сети.

## IS-IS
**IS-IS Routing Engine Service** — это сервис, который реализует протокол маршрутизации **IS-IS (Intermediate System to Intermediate System)** на маршрутизаторе. IS-IS — это протокол маршрутизации, использующий алгоритм **Dijkstra's SPF (Shortest Path First)**, который определяет наилучшие пути для передачи трафика между маршрутизаторами в рамках одной автономной системы (AS).

### Что такое IS-IS?

IS-IS — это протокол маршрутизации, используемый для обмена информацией о маршрутах между маршрутизаторами внутри одной автономной системы (AS), а также для маршрутизации в более крупных сетях, включая сети операторов связи и интернет-провайдеров. IS-IS был изначально разработан для работы в сети **ISO (International Organization for Standardization)**, но позже адаптирован для работы с **IP**-сетью.

### Основные особенности IS-IS:

1. **Алгоритм SPF (Dijkstra)**:
   IS-IS использует алгоритм SPF для вычисления наилучших путей через сеть, основываясь на топологии сети, которая передается через **LSA (Link-State Advertisements)**.

2. **Реализация через "уровни"**:
   IS-IS работает в два уровня:
   - **Level 1 (L1)** — маршруты внутри одной области (аналог OSPF Area).
   - **Level 2 (L2)** — маршруты между областями (аналог OSPF Area 0). IS-IS может работать как в пределах одной области, так и межобластно.

3. **Топология сети**:
   Как и в OSPF, IS-IS строит **Link-State Database (LSDB)**, которая хранит информацию о состоянии всех соединений и маршрутов в сети.

4. **Поддержка IPv6**:
   IS-IS поддерживает маршрутизацию как для **IPv4**, так и для **IPv6**, что делает его универсальным решением для современных сетей.

5. **Процесс маршрутизации**:
   IS-IS использует процесс маршрутизации, в котором маршрутизаторы обменяются информацией о своей топологии (состоянии связей) и затем вычисляют маршруты, используя алгоритм SPF.

### IS-IS Routing Engine Service в контексте устройства

**IS-IS Routing Engine Service** — это процесс или сервис, который обеспечивает выполнение самого протокола IS-IS на маршрутизаторе. Этот сервис отвечает за следующие функции:

1. **Обмен LSAs**: Обмен объявлениями о состоянии связей между маршрутизаторами для обновления таблицы маршрутизации и построения актуальной топологии сети.
2. **Реализация SPF-алгоритма**: После получения информации о состоянии связей от соседей маршрутизаторы используют алгоритм SPF для вычисления наилучших путей.
3. **Маршрутизация и обновление таблицы маршрутизации**: На основе вычисленных путей сервис обновляет таблицу маршрутизации, добавляя или удаляя маршруты.

### Зачем нужен IS-IS Routing Engine Service?

1. **Масштабируемость**: IS-IS эффективен в больших и сложных сетях, где требуется высокая производительность и возможность масштабирования. Он может работать в больших операционных сетях, таких как сети провайдеров.
   
2. **Высокая стабильность**: Благодаря своей архитектуре и алгоритму SPF, IS-IS может эффективно работать даже в условиях динамичных изменений сети, обеспечивая быстрые адаптации к изменениям топологии.

3. **Поддержка различных типов интерфейсов**: IS-IS может работать на различных типах сетевых интерфейсов и поддерживает мультипротокольность, включая работу с IPv4 и IPv6.

### Пример конфигурации IS-IS на маршрутизаторе:

Для включения IS-IS на маршрутизаторе и настройки базовых параметров, можно использовать команду в режиме конфигурации, как показано ниже (для сетей Cisco/Juniper или подобных):

```bash
router isis
net 49.0001.0000.0000.0001.00  # Уникальный NET ID для IS-IS
interface eth0
 isis enable  # Включение IS-IS на интерфейсе
 interface eth1
 isis enable  # Включение IS-IS на другом интерфейсе
 address-family ipv4 unicast
  isis metric 10  # Установка метрики для маршрута
  isis level-1  # Уровень 1 маршрутизации
  isis level-2  # Уровень 2 маршрутизации
exit
```

### Основные команды:

- **router isis** — Включение и настройка процесса IS-IS.
- **net** — Уникальный идентификатор сети, который используется для адресации в IS-IS.
- **isis enable** — Включение IS-IS на интерфейсе.
- **address-family ipv4 unicast** — Настройка маршрутизации для IPv4.
- **isis metric** — Установка метрики для маршрутов.
- **isis level-1 / level-2** — Настройка уровня маршрутизации (Level 1 для маршрутов внутри области, Level 2 для межобластных маршрутов).

### Заключение:

**IS-IS Routing Engine Service** представляет собой важный сервис маршрутизации, который обеспечивает работу протокола IS-IS на маршрутизаторе, позволяя эффективно обмениваться информацией о маршрутах и обновлять таблицу маршрутизации в больших и сложных сетях. Этот сервис играет ключевую роль в маршрутизации в операционных сетях, таких как сети провайдеров, и предоставляет высокую гибкость, надежность и производительность.
  
- [GNS3 Documentation](https://docs.gns3.com/)
- [Docker Documentation](https://docs.docker.com/)
- [frrouting Documentation](https://docs.frrouting.org/en/latest/index.html)

